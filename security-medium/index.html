<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pixel Pets - Virtual Pet Game</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Comic Sans MS', 'Chalkboard SE', cursive;
            background: linear-gradient(180deg, #87CEEB 0%, #98FB98 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .game-container {
            max-width: 900px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 3rem;
            color: #ff6b9d;
            text-shadow: 3px 3px 0 #fff, 4px 4px 0 #ff6b9d;
            margin-bottom: 10px;
        }

        .header p {
            color: #666;
            font-size: 1.2rem;
        }

        .stats-bar {
            display: flex;
            justify-content: space-around;
            background: white;
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        .stat {
            text-align: center;
        }

        .stat-label {
            font-size: 0.9rem;
            color: #888;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 1.8rem;
            font-weight: bold;
        }

        .coins { color: #ffd700; }
        .happiness { color: #ff6b9d; }
        .hunger { color: #ff6b6b; }
        .energy { color: #48dbfb; }

        .pet-area {
            background: white;
            border-radius: 30px;
            padding: 40px;
            text-align: center;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .pet-display {
            font-size: 150px;
            margin: 20px 0;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }

        .pet-name {
            font-size: 2rem;
            color: #333;
            margin-bottom: 10px;
        }

        .pet-mood {
            font-size: 1.2rem;
            color: #888;
            padding: 10px 30px;
            background: #f0f0f0;
            border-radius: 20px;
            display: inline-block;
        }

        .actions {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-top: 30px;
        }

        .action-btn {
            padding: 20px;
            border: none;
            border-radius: 15px;
            font-family: inherit;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .action-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }

        .action-btn .icon {
            font-size: 2rem;
        }

        .feed-btn { background: #ff6b6b; color: white; }
        .play-btn { background: #ffd700; color: #333; }
        .sleep-btn { background: #48dbfb; color: white; }
        .shop-btn { background: #a29bfe; color: white; }

        .shop-panel {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            display: none;
        }

        .shop-panel.active {
            display: block;
        }

        .shop-panel h2 {
            color: #a29bfe;
            margin-bottom: 20px;
            text-align: center;
        }

        .shop-items {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }

        .shop-item {
            background: #f8f8f8;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            border: 2px solid transparent;
            cursor: pointer;
            transition: all 0.3s;
        }

        .shop-item:hover {
            border-color: #a29bfe;
            transform: scale(1.05);
        }

        .shop-item .item-icon {
            font-size: 3rem;
            margin-bottom: 10px;
        }

        .shop-item .item-name {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .shop-item .item-price {
            color: #ffd700;
            font-weight: bold;
        }

        .message-box {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            padding: 20px 30px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            display: none;
            z-index: 1000;
        }

        .message-box.success {
            border-left: 5px solid #4caf50;
        }

        .message-box.error {
            border-left: 5px solid #f44336;
        }

        .hint-box {
            background: #fff3cd;
            border: 2px dashed #ffc107;
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            text-align: center;
        }

        .hint-box h3 {
            color: #856404;
            margin-bottom: 10px;
        }

        .hint-box p {
            color: #856404;
        }

        .flag-display {
            background: linear-gradient(45deg, #ff6b6b, #feca57, #48dbfb, #ff9ff3);
            background-size: 400% 400%;
            animation: rainbow 3s linear infinite;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            display: none;
        }

        @keyframes rainbow {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .flag-display h2 {
            color: white;
            text-shadow: 2px 2px 0 rgba(0,0,0,0.3);
        }

        .admin-link {
            position: fixed;
            bottom: 10px;
            right: 10px;
            font-size: 0.7rem;
            color: #ddd;
            text-decoration: none;
        }

        .admin-link:hover {
            color: #999;
        }

        .progress-tracker {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        .progress-tracker h3 {
            color: #333;
            margin-bottom: 15px;
            text-align: center;
        }

        .flags-found {
            display: flex;
            justify-content: center;
            gap: 20px;
        }

        .flag-slot {
            width: 60px;
            height: 60px;
            background: #f0f0f0;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            border: 3px dashed #ccc;
        }

        .flag-slot.found {
            background: linear-gradient(45deg, #ffd700, #ffed4a);
            border: 3px solid #ffd700;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="header">
            <h1>Pixel Pets</h1>
            <p>Take care of your virtual pet! Can you find all 4 hidden flags?</p>
        </div>

        <div class="stats-bar">
            <div class="stat">
                <div class="stat-label">Coins</div>
                <div class="stat-value coins" id="coins">100</div>
            </div>
            <div class="stat">
                <div class="stat-label">Happiness</div>
                <div class="stat-value happiness" id="happiness">50</div>
            </div>
            <div class="stat">
                <div class="stat-label">Hunger</div>
                <div class="stat-value hunger" id="hunger">50</div>
            </div>
            <div class="stat">
                <div class="stat-label">Energy</div>
                <div class="stat-value energy" id="energy">50</div>
            </div>
        </div>

        <div class="pet-area">
            <div class="pet-name" id="petName">Fluffy</div>
            <div class="pet-display" id="petDisplay">üê±</div>
            <div class="pet-mood" id="petMood">Feeling okay...</div>

            <div class="actions">
                <button class="action-btn feed-btn" onclick="feedPet()">
                    <span class="icon">üçï</span>
                    <span>Feed (10 coins)</span>
                </button>
                <button class="action-btn play-btn" onclick="playWithPet()">
                    <span class="icon">‚öΩ</span>
                    <span>Play</span>
                </button>
                <button class="action-btn sleep-btn" onclick="sleepPet()">
                    <span class="icon">üò¥</span>
                    <span>Sleep</span>
                </button>
                <button class="action-btn shop-btn" onclick="toggleShop()">
                    <span class="icon">üõí</span>
                    <span>Shop</span>
                </button>
            </div>

            <div id="flagDisplay" class="flag-display">
                <h2 id="flagMessage">FLAG FOUND!</h2>
            </div>
        </div>

        <div id="shopPanel" class="shop-panel">
            <h2>Pet Shop</h2>
            <div class="shop-items">
                <div class="shop-item" onclick="buyItem('hat', 50)">
                    <div class="item-icon">üé©</div>
                    <div class="item-name">Fancy Hat</div>
                    <div class="item-price">50 coins</div>
                </div>
                <div class="shop-item" onclick="buyItem('bow', 30)">
                    <div class="item-icon">üéÄ</div>
                    <div class="item-name">Pretty Bow</div>
                    <div class="item-price">30 coins</div>
                </div>
                <div class="shop-item" onclick="buyItem('glasses', 100)">
                    <div class="item-icon">üï∂Ô∏è</div>
                    <div class="item-name">Cool Glasses</div>
                    <div class="item-price">100 coins</div>
                </div>
                <div class="shop-item" onclick="buyItem('crown', 500)">
                    <div class="item-icon">üëë</div>
                    <div class="item-name">Royal Crown</div>
                    <div class="item-price">500 coins</div>
                </div>
                <div class="shop-item" onclick="buyItem('wings', 1000)">
                    <div class="item-icon">ü¶ã</div>
                    <div class="item-name">Butterfly Wings</div>
                    <div class="item-price">1000 coins</div>
                </div>
                <div class="shop-item" onclick="buyItem('dragon', 9999)">
                    <div class="item-icon">üêâ</div>
                    <div class="item-name">Dragon Pet</div>
                    <div class="item-price">9999 coins</div>
                </div>
            </div>
        </div>

        <div class="progress-tracker">
            <h3>Flags Found: <span id="flagCount">0</span>/4</h3>
            <div class="flags-found">
                <div class="flag-slot" id="flag1">?</div>
                <div class="flag-slot" id="flag2">?</div>
                <div class="flag-slot" id="flag3">?</div>
                <div class="flag-slot" id="flag4">?</div>
            </div>
        </div>

        <div class="hint-box">
            <h3>Hacker Training Hints:</h3>
            <p>Your browser stores data in different places. Have you checked where your coins are saved?</p>
            <p>Try opening Developer Tools (F12) and exploring the "Application" or "Storage" tab...</p>
            <p>Also, what happens if you look at the URL bar? Some pages accept special parameters...</p>
        </div>
    </div>

    <div id="messageBox" class="message-box"></div>

    <!-- Tiny admin link that blends in -->
    <a href="admin.html" class="admin-link">admin</a>

    <script>
        // Initialize game state from localStorage (VULNERABILITY: Client-side storage!)
        let gameState = {
            coins: 100,
            happiness: 50,
            hunger: 50,
            energy: 50,
            petName: 'Fluffy',
            items: [],
            flagsFound: []
        };

        // Load saved state
        function loadGame() {
            const saved = localStorage.getItem('pixelPetsGame');
            if (saved) {
                gameState = JSON.parse(saved);
            }

            // Check URL parameters (VULNERABILITY: URL parameter manipulation)
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.has('coins')) {
                gameState.coins = parseInt(urlParams.get('coins')) || gameState.coins;
            }
            if (urlParams.has('debug') && urlParams.get('debug') === 'true') {
                console.log("DEBUG MODE ENABLED!");
                console.log("Game State:", gameState);
                console.log("Hint: You can also try ?coins=99999 in the URL!");
            }

            updateDisplay();
            checkForFlags();
        }

        // Save game state
        function saveGame() {
            localStorage.setItem('pixelPetsGame', JSON.stringify(gameState));
            updateDisplay();
            checkForFlags();
        }

        // Update the display
        function updateDisplay() {
            document.getElementById('coins').textContent = gameState.coins;
            document.getElementById('happiness').textContent = gameState.happiness;
            document.getElementById('hunger').textContent = gameState.hunger;
            document.getElementById('energy').textContent = gameState.energy;
            document.getElementById('petName').textContent = gameState.petName;

            // Update pet mood
            const avgStats = (gameState.happiness + (100 - gameState.hunger) + gameState.energy) / 3;
            const moodDisplay = document.getElementById('petMood');
            const petDisplay = document.getElementById('petDisplay');

            if (avgStats > 80) {
                moodDisplay.textContent = "Super happy! üåü";
                petDisplay.textContent = "üò∫";
            } else if (avgStats > 50) {
                moodDisplay.textContent = "Feeling good! üòä";
                petDisplay.textContent = "üê±";
            } else if (avgStats > 25) {
                moodDisplay.textContent = "Could be better... üòê";
                petDisplay.textContent = "üòø";
            } else {
                moodDisplay.textContent = "Please take care of me! üò¢";
                petDisplay.textContent = "üôÄ";
            }

            // Update flag count
            document.getElementById('flagCount').textContent = gameState.flagsFound.length;
            gameState.flagsFound.forEach(flag => {
                const slot = document.getElementById('flag' + flag);
                if (slot) {
                    slot.textContent = 'üèÅ';
                    slot.classList.add('found');
                }
            });
        }

        // Check for flag conditions
        function checkForFlags() {
            // Flag 1: Have more than 9000 coins (localStorage manipulation)
            if (gameState.coins > 9000 && !gameState.flagsFound.includes(1)) {
                captureFlag(1, "LocalStorage Master! You modified your coin balance!");
            }

            // Flag 2: Own the dragon pet
            if (gameState.items.includes('dragon') && !gameState.flagsFound.includes(2)) {
                captureFlag(2, "Dragon Tamer! You got the most expensive item!");
            }

            // Flag 3: Max out all stats to 100+
            if (gameState.happiness >= 100 && gameState.energy >= 100 && (100 - gameState.hunger) >= 50 && !gameState.flagsFound.includes(3)) {
                captureFlag(3, "Perfect Pet Parent! All stats maxed out!");
            }
        }

        function captureFlag(flagNum, message) {
            if (!gameState.flagsFound.includes(flagNum)) {
                gameState.flagsFound.push(flagNum);
                saveGame();

                const flagDisplay = document.getElementById('flagDisplay');
                const flagMessage = document.getElementById('flagMessage');
                flagMessage.textContent = `FLAG #${flagNum}: ${message}`;
                flagDisplay.style.display = 'block';

                setTimeout(() => {
                    flagDisplay.style.display = 'none';
                }, 5000);

                console.log(`üèÅ FLAG #${flagNum} CAPTURED: ${message}`);
            }
        }

        // Game actions
        function feedPet() {
            if (gameState.coins >= 10) {
                gameState.coins -= 10;
                gameState.hunger = Math.max(0, gameState.hunger - 20);
                gameState.happiness = Math.min(100, gameState.happiness + 5);
                showMessage("Yummy! Your pet loved the food! üçï", "success");
                saveGame();
            } else {
                showMessage("Not enough coins! üò¢", "error");
            }
        }

        function playWithPet() {
            if (gameState.energy >= 10) {
                gameState.energy -= 10;
                gameState.happiness = Math.min(100, gameState.happiness + 15);
                gameState.hunger = Math.min(100, gameState.hunger + 5);
                showMessage("So much fun! ‚öΩ", "success");
                saveGame();
            } else {
                showMessage("Your pet is too tired to play! üò¥", "error");
            }
        }

        function sleepPet() {
            gameState.energy = Math.min(100, gameState.energy + 30);
            gameState.hunger = Math.min(100, gameState.hunger + 10);
            showMessage("Zzz... Your pet is resting! üò¥", "success");
            saveGame();
        }

        function toggleShop() {
            const shop = document.getElementById('shopPanel');
            shop.classList.toggle('active');
        }

        function buyItem(item, price) {
            if (gameState.coins >= price) {
                gameState.coins -= price;
                if (!gameState.items.includes(item)) {
                    gameState.items.push(item);
                }
                showMessage(`You bought a ${item}! üéâ`, "success");
                saveGame();
            } else {
                showMessage(`Not enough coins! Need ${price} coins.`, "error");
            }
        }

        function showMessage(text, type) {
            const msgBox = document.getElementById('messageBox');
            msgBox.textContent = text;
            msgBox.className = 'message-box ' + type;
            msgBox.style.display = 'block';

            setTimeout(() => {
                msgBox.style.display = 'none';
            }, 3000);
        }

        // Console hints for curious students
        console.log("===========================================");
        console.log("Welcome to Pixel Pets!");
        console.log("===========================================");
        console.log("Hint 1: Check localStorage in the Application tab");
        console.log("Hint 2: Try adding ?debug=true to the URL");
        console.log("Hint 3: Look for hidden links on the page");
        console.log("Hint 4: There's an admin page somewhere...");
        console.log("===========================================");

        // Initialize game
        loadGame();

        // Decay stats over time (every 30 seconds)
        setInterval(() => {
            gameState.hunger = Math.min(100, gameState.hunger + 2);
            gameState.happiness = Math.max(0, gameState.happiness - 1);
            gameState.energy = Math.max(0, gameState.energy - 1);
            saveGame();
        }, 30000);
    </script>
</body>
</html>
